---
title: "[next/jest] jest-transform-graphql ã§ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒ©ãƒ¼"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["jest", "javascript", "typescript", "nextjs", "nodejs"]
published: true
---

## å®Ÿè¡Œç’°å¢ƒ

```json
"jest": "29.5.0"
"next": "13.2.4"
```

## jest-transform-graphql ã§ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒ©ãƒ¼

graphql ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã‚€éš›ã€`jest-transform-graphql`ã‚’åˆ©ç”¨ã—ã¦ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡Œã†ã®ã§ã™ãŒã€ä¸‹è¨˜ã®ã‚¨ãƒ©ãƒ¼ã«é­é‡ã—ã¾ã—ãŸã€‚
`jest`ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³`28`ã®ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ³ã‚°ãƒã‚§ãƒ³ã‚¸ã§ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã¨ã•ã‚Œã¦ã„ã¾ã™ãŒã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³`29`ã§ã‚‚åŒæ§˜ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

```
    `process()` or/and `processAsync()` method of code transformer found at
    "node_modules/jest-transform-graphql/index.js"
    should return an object or a Promise resolving to an object. The object
    must have `code` property with a string of processed code.
    This error may be caused by a breaking change in Jest 28:
    https://jestjs.io/docs/upgrading-to-jest28#transformer
    Code Transformation Documentation:
    https://jestjs.io/docs/code-transformation
```

### å¯¾å‡¦æ–¹æ³•

`transform-graphql-jest`ã«`code`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä»˜ä¸ã™ã‚‹ã‚ˆã†ã«æ›¸ãæ›ãˆã¦ transform ã«è¨­å®šã™ã‚‹ã¨åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
ä¸€æ™‚çš„ãªå¯¾å¿œãªã®ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸ŠãŒã£ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æŒ™å‹•ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

```js
...
transform: {
    '\\.(gql|graphql)$': './transform-graphql-jest-similar.js',
}
```

```js
// transform-graphql-jest-similar.js
const { process: upstreamProcess } = require("jest-transform-graphql");

const process = (...args) => {
  const code = upstreamProcess(...args);
  return { code };
};

module.exports = { process };
```

## å‚ç…§

- [Jest 28 failure: should return an object or a Promise resolving to an object](https://github.com/remind101/jest-transform-graphql/issues/13)
